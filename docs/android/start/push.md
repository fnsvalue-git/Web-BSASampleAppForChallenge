---
sidebar_position: 2
---
# FCM Registration

## Overview
This is the description on how to implement authentication push notification feature in GCCS.

<br/>

## Feature Description
When requesting GCCS authentication from a non-mobile platform such as the web or Window, FCM registration and token update features are required in order to receive push notifications for authentication request in the mobile application that implement the Guardian SDK.

## FCM SERVER KEY Check
In order to receive authentication notifications, we must send the server key issued by Firebase Cloud Messaging (FCM) when requesting client issuance.   
We can check the FCM SERVER KEY as follows.
1. Creates or loads the project in [Firebase Console](https://console.firebase.google.com/).
2. [Project Settings] > Check the Server Key from [Cloud Messaging] menu.

Please check the FCM SEVER KEY and request the client issue together.

## FCM push notification token registration
As for the FCM token for authentication push notification, please register and update the token generated by Android devices by using the `registerPushToken()` function from `GuardianSdk`.
Even when the FCM token is changed due to expiration, etc., an update is required and you can use the `registerPushToken()` function for  it.

### Parameter
|Key|Value|Description|
|------|---|---|
|token|String|FCM push notification token|

### Example
```java
// FCM Push Notificaiton Token Registration
FirebaseInstanceId.getInstance().getInstanceId()
    .addOnSuccessListener(new OnSuccessListener<InstanceIdResult>() {
        public void onSuccess(InstanceIdResult instanceIdResult) {
            String token = instanceIdResult.getToken();

            GuardianSdk.getInstance().registerPushToken(token, new GuardianResponseCallback<TokenResponse>() {
                @Override
                public void onSuccess(TokenResponse result) {
                    Log.i(TAG, "Result code : " + result.rtCode);
                }
                @Override
                public void onFailed(ErrorResult errorResult) {
                    Log.e(TAG, "Error code : " + errorResult.getErrorCode());
                }
            });
        }
});

// FCM Push Notificaiton Relash Token
public class FirebasePushService extends FirebaseMessagingService {
    @Override
    public void onMessageReceived(RemoteMessage remoteMessage) {
    }

    @Override
    public void onNewToken(String token) {
        super.onNewToken(token);
        GuardianSdk.getInstance().registerPushToken(token, new GuardianResponseCallback<TokenResponse>() {
            @Override
            public void onSuccess(TokenResponse result) {
                Log.i(TAG, "Result code : " + result.rtCode);
            }

            @Override
            public void onFailed(ErrorResult errorResult) {
                Log.e(TAG, "Error code : " + errorResult.getErrorCode());
            }
        });
    }
}
```
### TokenResponse
|Key|Value|Description|
|------|---|---|
|rtCode|0|Result code|
|rtMsg|String|Result message|

If FCM push notification token registration is being called successfully, the `rtCode` will be `0`.

### ErrorResult
|Key|Value|Description|
|------|---|---|
|errorCode|Int|Error code|
|ErrorMessage|String|Error message|

## FCM push notification token removal
As for FCM push notification token removal, please use the `deregisterPushToken()` function of `GuardianSdk` to remove the android device FCM token.
### Parameter
- none

### Example
```java
// FCM push notification token removal
GuardianSdk.getInstance().deregisterPushToken(new GuardianResponseCallback<TokenResponse>() {
    @Override
    public void onSuccess(TokenResponse result) {
        Log.i(TAG, "Result code : " + result.rtCode);
    }

    @Override
    public void onFailed(ErrorResult errorResult) {
        Log.e(TAG, "Error code : " + errorResult.getErrorCode());
    }
});
```
### TokenResponse
|Key|Value|Description|
|------|---|---|
|rtCode|0|Result code|
|rtMsg|String|Result message|

If FCM push notification token removal is being called successfully, the `rtCode` will be `0`.

### ErrorResult
|Key|Value|Description|
|------|---|---|
|errorCode|Int|Error code|
|ErrorMessage|String|Error message|
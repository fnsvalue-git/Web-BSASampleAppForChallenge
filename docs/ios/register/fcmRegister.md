---
sidebar_position: 2
---
# FCM Registration

## Overview
This document describes how to configure the push notification feature in the GCCS authentication process.

<br/>

## Feature Description
There can be circumstances when the user requests GCCS authentication from a non-mobile platform such as the web or window.  
To receive the push notification in the mobile app that has implemented the iOS SDK, FCM registration and the token update is necessary.

## FCM Server key

In order to receive the push notifications, the server key generated by Firebase Cloud Messaging (FCM) must be sent together with the client issuance request.
The FCM server key can be found in the process below.
1. Create or load the project in the [Firebase Console](https://console.firebase.google.com/).
2. [Project Settings] > get the Server Key from [Cloud Messaging] menu.

If the client needs registration, note that the FCM server key is indispensable.


## FCM Push notification token registration
FCM push token should be registered so that it can be used for notifying authentication request.
By using the `requestTokenUpdate()` from `GuardianService`, the FCM push token that was generated from the iOS device can be called to be registered and updated.

FCM push token can be changed due to expiration, etc. It should be updated by calling `requestTokenUpdate()`.

### Parameter
|Key|Value|Description|
|------|---|---|
|token|String|FCM push notification token|

### Example
```java
// FCM Push notification token registered
public func requestTokenUpdate(token : String, onSuccess: @escaping(RtCode, String)-> Void, onFailed: @escaping(RtCode, String)-> Void) {
    let apiUrl = "me/token"

    var params = getCommonParam()
    params["deviceId"] = getUUid()
    params["token"] = token
    params["osVersion"] = getOSVersion()
    params["appVersion"] = getAppVersion()

    self.callHttpMethod(params: params, api: apiUrl, method: .put) { (data: JSON) in
        let rtCode = data["rtCode"].intValue
        let rtMsg = data["rtMsg"].string ?? ""
        if(rtCode == RtCode.AUTH_SUCCESS.rawValue) {
            onSuccess(RtCode(rawValue: rtCode)!, rtMsg)
        } else {
            self.onCallbackFailed(rtCode: RtCode(rawValue: rtCode)!, onFailed: onFailed)
        }
    } errorCallBack: { (errorCode, errorMsg) in
            onFailed(RtCode.API_ERROR, errorMsg)
        }
    }
```
### TokenResponse
|Key|Value|Description|
|------|---|---|
|rtCode|0|Result code|
|rtMsg|String|Result message|

If the API call to register FCM push token is successful, the `rtCode` will be `0`

### ErrorResult
|Key|Value|Description|
|------|---|---|
|errorCode|Int|Error code|
|errorMessage|String|Error message|

If API call fails, the user will receive an `errorCode`